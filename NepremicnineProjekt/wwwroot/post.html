<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Post</title>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body>

<div id="header"></div>

<section class="main-section" style="padding: 20px;text-align: center; font-family: Arial, sans-serif;">
    <h1 id="post-title" style="color: #ffffff; margin-bottom: 15px;">Title</h1>
    <img id="post-img" style="width: 100%; max-width: 500px; border-radius: 10px; margin-bottom: 15px;" src="https://img.nepremicnine.net/slonep_oglasi2/18630086.jpg" alt="Property Image">
    <p id="post-size" style="color: #ffffff; font-weight: bold; margin: 5px 0;">Size: 100m²</p>
    <p id="post-price" style="color: #ffffff; font-weight: bold; margin: 5px 0;">Price: 200,000€</p>
    <p id="post-desc" style="color: #cccccc; margin-top: 10px;">Description of the property goes here. Short and concise text looks clean.</p>
    <button id="delete-button" style="background-color: #ff4d4d; color: white; border: none; padding: 10px 20px; font-size: 16px; border-radius: 5px; cursor: pointer; margin-top: 15px;">
        Delete Post
    </button>
</section>

<div id="footer"></div>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    const postId = urlParams.get("id");

    fetch(`/post?id=${postId}`)
        .then(res => res.json())
        .then(post => {
            document.getElementById("post-title").textContent = post.title;
            document.getElementById("post-img").src = post.imageUrl;
            document.getElementById("post-size").textContent = "Size: " + post.size + " m2";
            document.getElementById("post-price").textContent = "Price: " + post.price + " €";
            document.getElementById("post-desc").textContent = post.description;
        })
        .catch(err => {
            document.body.innerHTML = "<h1 style='color:white; text-align:center;'>Post not found</h1>";
        });

    document.getElementById("delete-button").addEventListener("click", () => {
        if(!confirm("Are you sure you want to delete this post?")) return;

        fetch(`/delete-post?id=${postId}`, { method: "DELETE" })
            .then(res => {
                if(res.ok){
                    alert("Post deleted successfully");
                    window.location.href = "/posts";
                } else {
                    alert("Failed to delete post");
                }
            })
            .catch(err => alert("Error deleting post"));
    });
</script>

</body>

<script>
    fetch("header.html")
        .then(res => res.text())
        .then(html => document.getElementById("header").innerHTML = html);

    fetch("footer.html")
        .then(res => res.text())
        .then(html => document.getElementById("footer").innerHTML = html);
</script>

</html>